shiny::runApp('~/Desktop/workout02-dan-zhao')
?sliderInput
runApp('~/Desktop/STAT133CompWithData/class/4_8/app_4_8note.R')
runApp('~/Desktop/workout02-dan-zhao')
?renderPlot
runApp('~/Desktop/workout02-dan-zhao')
runApp('~/Desktop/workout02-dan-zhao')
runApp('~/Desktop/workout02-dan-zhao')
runApp('~/Desktop/workout02-dan-zhao')
runApp('~/Desktop/workout02-dan-zhao')
runApp('~/Desktop/workout02-dan-zhao')
runApp('~/Desktop/workout02-dan-zhao')
runApp('~/Desktop/workout02-dan-zhao')
runApp('~/Desktop/workout02-dan-zhao')
runApp('~/Desktop/workout02-dan-zhao')
knitr::opts_chunk$set(echo = TRUE, error = TRUE)
#' @title Future Value
#' @description computes the future value of an investment
#' @param amount initial invested amount
#' @param rate annual rate of return
#' @param years number of years
#' @return future value
future_value <- function(amount, rate, years){
fv = amount*(1+rate)^years
return(fv)
}
# test
future_value(amount = 100, rate = 0.05, years = 1)
future_value(amount = 500, rate = 0.05, years = 5)
future_value(amount = 1000, rate = 0.05, years = 10)
#' @title future value of annuity
#' @description computes the future value of annuity
#' @param contrib contributed amount
#' @param rate annual rate of return
#' @param years number of years
#' @return future value of annuity
annuity <- function(contrib,rate,years){
fva = contrib*((1+rate)^years-1)/rate
return(fva)
}
annuity(contrib = 200, rate = 0.05, years = 1)
annuity(contrib = 200, rate = 0.05, years = 2)
annuity(contrib = 200, rate = 0.05, years = 10)
#' @title growing annuity
#' @description computes the future value of growing annuity
#' @param contrib contributed amount
#' @param rate annual rate of return
#' @param growth annual growth rate
#' @param years number of years
#' @return future value of annuity
growing_annuity <- function(contrib, rate, growth, years){
fvga <- contrib * ((1+rate)^years-(1+growth)^years) / (rate-growth)
return(fvga)
}
growing_annuity(contrib = 200, rate = 0.05, growth = 0.03, years = 1)
growing_annuity(contrib = 200, rate = 0.05, growth = 0.03, years = 2)
growing_annuity(contrib = 200, rate = 0.05, growth = 0.03, years = 10)
year = 0:10
no_contrib = rep(0, length(year))
fixed_contrib = rep(0, length(year))
growing_contrib = rep(0, length(year))
for (i in 1:length(year)){
no_contrib[i] = future_value(amount = 1000, rate = 0.05, years = year[i])
fixed_contrib[i] = no_contrib[i] + annuity(contrib = 200, rate = 0.05, years = year[i])
growing_contrib[i] = no_contrib[i] + growing_annuity(contrib = 200, rate = 0.05, growth = 0.03, years = year[i])
}
modalities = data.frame(year, no_contrib, fixed_contrib, growing_contrib)
modalities
library(ggplot2)
ggplot(data = modalities, aes(x=year))+
geom_line(aes(y=no_contrib,color='no_contrib'),linetype=1,size=1)+
geom_point(aes(y=no_contrib,color='no_contrib'))+
geom_line(aes(y=fixed_contrib,color='fixed_contrib'),linetype=1,size=1)+
geom_point(aes(y=fixed_contrib,color='fixed_contrib'))+
geom_line(aes(y=growing_contrib,color='growing_contrib'),linetype=1,size=1)+
geom_point(aes(y=growing_contrib,color='growing_contrib'))+
labs(x="Year",y="Annual Balances",title="Annual Balances of Each Savings-investing Modality")+
xlim(0,10)+
ylim(1000,4500)+
scale_colour_manual("Modality",breaks = c('no_contrib','fixed_contrib','growing_contrib'),values = c('no_contrib'='red','fixed_contrib'='green','growing_contrib'='blue'))+
theme_bw()
rates = c(0.001,0.0225,0.065)
savings = c('regular saving','high-yield savings','index fund')
year = 0:15
no_contrib = rep(0, length(year))
fixed_contrib = rep(0, length(year))
growing_contrib = rep(0, length(year))
lst = list()
for (j in 1:length(rates)){
for (i in 1:length(year)){
no_contrib[i] = future_value(amount = 10000, rate = rates[j], years = year[i])
fixed_contrib[i] = no_contrib[i] + annuity(contrib = 2000, rate = rates[j], years = year[i])
growing_contrib[i] = no_contrib[i] + growing_annuity(contrib = 2000, rate = rates[j],
growth = 0.04, years = year[i])
}
saving_modes = rep(savings[j],length(year))
lst[[j]]=data.frame(saving_modes,year,no_contrib,fixed_contrib,growing_contrib)
}
modalities_comb <- rbind(lst[[1]],lst[[2]],lst[[3]])
modalities_comb
ggplot(data=modalities_comb,aes(x=year))+
facet_grid(.~saving_modes)+
geom_line(aes(y=no_contrib,color='no_contrib'))+
geom_point(aes(y=no_contrib,color='no_contrib'),size=0.5)+
geom_line(aes(y=fixed_contrib,color='fixed_contrib'))+
geom_point(aes(y=fixed_contrib,color='fixed_contrib'),size=0.5)+
geom_line(aes(y=growing_contrib,color='growing_contrib'))+
geom_point(aes(y=growing_contrib,color='growing_contrib'),size=0.5)+
labs(x="Year",y="Annual Balances",title="Annual Balances of the Nine Different Savings Scenarios")+
xlim(0,15)+
ylim(10000,90000)+
scale_colour_manual("Modality",breaks = c('no_contrib','fixed_contrib','growing_contrib'),values = c('no_contrib'='red','fixed_contrib'='green','growing_contrib'='blue'))+
theme_bw()
modalities$year
a = modalities$year
a
year
rep(year,3)
c(no_contrib, fixed_contrib, growing_contrib)
shiny::runApp('~/Desktop/workout02-dan-zhao')
! 1
!1
runApp('~/Desktop/workout02-dan-zhao')
runApp('~/Desktop/workout02-dan-zhao')
runApp('~/Desktop/workout02-dan-zhao')
runApp('~/Desktop/workout02-dan-zhao')
runApp('~/Desktop/workout02-dan-zhao')
runApp('~/Desktop/workout02-dan-zhao')
runApp('~/Desktop/workout02-dan-zhao')
runApp('~/Desktop/workout02-dan-zhao')
runApp('~/Desktop/workout02-dan-zhao')
runApp('~/Desktop/workout02-dan-zhao')
runApp('~/Desktop/workout02-dan-zhao')
runApp('~/Desktop/workout02-dan-zhao')
runApp('~/Desktop/workout02-dan-zhao')
runApp('~/Desktop/workout02-dan-zhao')
?sidebarLayout
?hr
runApp('~/Desktop/workout02-dan-zhao')
runApp('~/Desktop/workout02-dan-zhao')
runApp('~/Desktop/workout02-dan-zhao')
install.packages('rsconnect')
rsconnect::setAccountInfo(name='zhaodanzju',
token='E264E657B429B039B236069E56CFB04E',
secret='<SECRET>')
rsconnect::setAccountInfo(name='zhaodanzju', token='E264E657B429B039B236069E56CFB04E', secret='PB5zPtxGEIg6bQdGkfRZndiOQmrxhOCkE68H16fN')
library(rsconnect)
rsconnect::deployApp('path/to/your/app')
getwd()
setwd(/Users/apple/Desktop/workout02-dan-zhao)
?setwd
getwd()
setwd(..)
setwd(Users/apple/Desktop/workout02-dan-zhao)
getwd()
setwd("~/Desktop/workout02-dan-zhao")
rsconnect::deployApp()
